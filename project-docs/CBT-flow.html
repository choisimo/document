<!DOCTYPE html>
<html>
<head>
<title>CBT-flow.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="cbt-diary-%EC%A0%84%EC%B2%B4-%EA%B8%B0%EB%8A%A5%EB%B3%84-%EB%B9%84%EC%A6%88%EB%8B%88%EC%8A%A4-%ED%9D%90%EB%A6%84%EB%8F%84">CBT Diary: ì „ì²´ ê¸°ëŠ¥ë³„ ë¹„ì¦ˆë‹ˆìŠ¤ íë¦„ë„</h1>
<p>ë³¸ ë¬¸ì„œëŠ” ì‚¬ìš©ìê°€ React-Native í´ë¼ì´ì–¸íŠ¸ì—ì„œ íŠ¹ì • ì‘ì—…ì„ ìˆ˜í–‰í–ˆì„ ë•Œ, Auth-server(Spring Boot), ai-server(Python), ê·¸ë¦¬ê³  ë°ì´í„°ë² ì´ìŠ¤(MariaDB, Redis) ê°„ì— ë°ì´í„°ê°€ ì–´ë–»ê²Œ íë¥´ëŠ”ì§€ ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ìœ¼ë¡œ ì‹œê°í™”í•œ ê²ƒì…ë‹ˆë‹¤.</p>
<blockquote>
<p><strong>ì°¸ê³ </strong>: í˜„ì¬ í”„ë¡œì íŠ¸ì˜ ì£¼ ë°ì´í„°ë² ì´ìŠ¤ëŠ” MariaDBì…ë‹ˆë‹¤. ì¼ê¸°, ì‚¬ìš©ì ì •ë³´, AI ë¶„ì„ ê²°ê³¼ ë“± í•µì‹¬ ë°ì´í„°ëŠ” ëª¨ë‘ MariaDBì— ì €ì¥ ë° ê´€ë¦¬ë©ë‹ˆë‹¤.</p>
</blockquote>
<h2 id="1-%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%9D%B8%EC%A6%9D-authentication">1. ì‚¬ìš©ì ì¸ì¦ (Authentication)</h2>
<h3 id="11-%EC%82%AC%EC%9A%A9%EC%9E%90-%ED%9A%8C%EC%9B%90%EA%B0%80%EC%9E%85">1.1. ì‚¬ìš©ì íšŒì›ê°€ì…</h3>
<p>ì‚¬ìš©ìê°€ ì•±ì—ì„œ ì´ë©”ì¼, ë¹„ë°€ë²ˆí˜¸, ì´ë¦„ ë“± ì •ë³´ë¥¼ ì…ë ¥í•˜ê³  'íšŒì›ê°€ì…'ì„ ìš”ì²­í–ˆì„ ë•Œì˜ íë¦„ì…ë‹ˆë‹¤.</p>
<pre><code class="language-mermaid"><div class="mermaid">sequenceDiagram
    participant Client as CBT-front (React-Native)
    participant AuthServer as Auth-server (Spring Boot)
    participant Database as MariaDB

    Client->>AuthServer: 1. íšŒì›ê°€ì… ìš”ì²­ (POST /api/users/join) <br> {email, password, name}
    activate AuthServer

    AuthServer->>Database: 2. ì´ë©”ì¼ ì¤‘ë³µ í™•ì¸ (SELECT)
    activate Database
    Database-->>AuthServer: 3. ì¤‘ë³µ ì—¬ë¶€ ë°˜í™˜
    deactivate Database

    alt ì´ë©”ì¼ ì‚¬ìš© ê°€ëŠ¥
        AuthServer->>AuthServer: 4. ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™” (BCrypt)
        AuthServer->>Database: 5. ì‚¬ìš©ì ì •ë³´ ì €ì¥ (INSERT INTO users)
        activate Database
        Database-->>AuthServer: 6. ì €ì¥ ì™„ë£Œ
        deactivate Database

        AuthServer-->>Client: 7. íšŒì›ê°€ì… ì„±ê³µ ì‘ë‹µ (201 Created)
    else ì´ë©”ì¼ ì¤‘ë³µ
        AuthServer-->>Client: 7. íšŒì›ê°€ì… ì‹¤íŒ¨ ì‘ë‹µ (409 Conflict)
    end
    deactivate AuthServer
</div></code></pre>
<h3 id="12-%EC%82%AC%EC%9A%A9%EC%9E%90-%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EB%B0%8F-%ED%86%A0%ED%81%B0-%EA%B4%80%EB%A6%AC">1.2. ì‚¬ìš©ì ë¡œê·¸ì¸ ë° í† í° ê´€ë¦¬</h3>
<p>ì‚¬ìš©ìê°€ ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¡œ 'ë¡œê·¸ì¸'ì„ ìš”ì²­í–ˆì„ ë•Œì˜ ì¸ì¦ ë° í† í° ë°œê¸‰/ì €ì¥ íë¦„ì…ë‹ˆë‹¤.</p>
<pre><code class="language-mermaid"><div class="mermaid">sequenceDiagram
    participant Client as CBT-front (React-Native)
    participant AuthServer as Auth-server (Spring Boot)
    participant Database as MariaDB
    participant Cache as Redis

    Client->>AuthServer: 1. ë¡œê·¸ì¸ ìš”ì²­ (POST /api/auth/login) <br> {email, password}
    activate AuthServer

    AuthServer->>Database: 2. ì‚¬ìš©ì ì •ë³´ ë° ì•”í˜¸í™”ëœ ë¹„ë°€ë²ˆí˜¸ ì¡°íšŒ (SELECT)
    activate Database
    Database-->>AuthServer: 3. ì‚¬ìš©ì ì •ë³´ ë°˜í™˜
    deactivate Database

    AuthServer->>AuthServer: 4. ë¹„ë°€ë²ˆí˜¸ ì¼ì¹˜ ì—¬ë¶€ í™•ì¸

    alt ì¸ì¦ ì„±ê³µ
        AuthServer->>AuthServer: 5. Access & Refresh í† í° ìƒì„± (JWT)

        AuthServer->>Cache: 6. Refresh í† í° ì €ì¥ (SET user_email:token)
        activate Cache
        Cache-->>AuthServer: 7. ì €ì¥ ì™„ë£Œ
        deactivate Cache

        AuthServer-->>Client: 8. í† í° ë° ì‚¬ìš©ì ì •ë³´ ì‘ë‹µ <br> {accessToken, refreshToken, user}

        Client->>Client: 9. ê¸°ê¸°ì— í† í° ë° ì‚¬ìš©ì ì •ë³´ ì €ì¥ (AsyncStorage)

    else ì¸ì¦ ì‹¤íŒ¨
        AuthServer-->>Client: 8. ë¡œê·¸ì¸ ì‹¤íŒ¨ ì‘ë‹µ (401 Unauthorized)
    end

    deactivate AuthServer
</div></code></pre>
<h2 id="2-%EC%9D%BC%EA%B8%B0-%EA%B4%80%EB%A6%AC-diary-management">2. ì¼ê¸° ê´€ë¦¬ (Diary Management)</h2>
<h3 id="21-%EC%9D%BC%EA%B8%B0-%EC%9E%91%EC%84%B1-%EB%B0%8F-ai-%EA%B0%90%EC%A0%95-%EB%B6%84%EC%84%9D">2.1. ì¼ê¸° ì‘ì„± ë° AI ê°ì • ë¶„ì„</h3>
<p>ì‚¬ìš©ìê°€ ì¼ê¸°ë¥¼ ì‘ì„±í•˜ê³  'ì €ì¥'ì„ ìš”ì²­í–ˆì„ ë•Œ, ì¼ê¸° ì €ì¥ê³¼ AI ë¶„ì„ì´ í•¨ê»˜ ì´ë£¨ì–´ì§€ëŠ” ë¹„ë™ê¸° íë¦„ì…ë‹ˆë‹¤.</p>
<pre><code class="language-mermaid"><div class="mermaid">sequenceDiagram
    participant Client as CBT-front (React-Native)
    participant AuthServer as Auth-server (Spring Boot)
    participant AiServer as ai-server (Python/FastAPI)
    participant OpenAIApi as ì™¸ë¶€ LLM (GPT)
    participant Database as MariaDB

    Client->>AuthServer: 1. ì¼ê¸° ì €ì¥ ìš”ì²­ (POST /api/diary) <br> {title, content, weather}
    activate AuthServer

    AuthServer->>Database: 2. ì¼ê¸° ì •ë³´ ì €ì¥ (INSERT INTO diary)
    activate Database
    Database-->>AuthServer: 3. ì €ì¥ëœ ì¼ê¸°(diary_id) ë°˜í™˜
    deactivate Database

    AuthServer-->>Client: 4. ì¼ê¸° ì €ì¥ ì„±ê³µ ì‘ë‹µ (201 Created)

    par AI ë¶„ì„ (ë¹„ë™ê¸° ì²˜ë¦¬)
        AuthServer->>AiServer: 5. ì¼ê¸° ë¶„ì„ ìš”ì²­ (POST /analyze) <br> {text: diary.content}
        activate AiServer

        AiServer->>OpenAIApi: 6. í”„ë¡¬í”„íŠ¸ ê¸°ë°˜ ë¶„ì„ ìš”ì²­
        activate OpenAIApi
        OpenAIApi-->>AiServer: 7. ë¶„ì„ ê²°ê³¼ ë°˜í™˜
        deactivate OpenAIApi

        AiServer->>AiServer: 8. ê²°ê³¼ í¬ë§·íŒ… (JSON)
        AiServer-->>AuthServer: 9. ë¶„ì„ ê²°ê³¼ JSON ì‘ë‹µ
        deactivate AiServer

        AuthServer->>Database: 10. ë¶„ì„ ê²°ê³¼ ì €ì¥ (INSERT INTO report)
        activate Database
        Database-->>AuthServer: 11. ì €ì¥ëœ ë¶„ì„(report_id) ë°˜í™˜
        deactivate Database

        AuthServer->>Database: 12. ì¼ê¸°ì™€ ë¶„ì„ ê²°ê³¼ ì—°ê²° <br> (UPDATE diary SET report_id = ?)
    end
    deactivate AuthServer
</div></code></pre>
<h3 id="22-%ED%8A%B9%EC%A0%95-%EB%82%A0%EC%A7%9C%EC%9D%98-%EC%9D%BC%EA%B8%B0-%EB%AA%A9%EB%A1%9D-%EC%A1%B0%ED%9A%8C">2.2. íŠ¹ì • ë‚ ì§œì˜ ì¼ê¸° ëª©ë¡ ì¡°íšŒ</h3>
<p>ì‚¬ìš©ìê°€ ìº˜ë¦°ë”ì—ì„œ íŠ¹ì • ë‚ ì§œë¥¼ ì„ íƒí–ˆì„ ë•Œ, í•´ë‹¹ ë‚ ì§œì— ì‘ì„±ëœ ëª¨ë“  ì¼ê¸°ì˜ ìš”ì•½ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” íë¦„ì…ë‹ˆë‹¤.</p>
<pre><code class="language-mermaid"><div class="mermaid">sequenceDiagram
    participant Client as CBT-front (React-Native)
    participant AuthServer as Auth-server (Spring Boot)
    participant Database as MariaDB

    Client->>AuthServer: 1. íŠ¹ì • ë‚ ì§œ ì¼ê¸° ëª©ë¡ ìš”ì²­ (GET /api/diary/calendar?date=YYYY-MM-DD)
    activate AuthServer

    AuthServer->>Database: 2. í•´ë‹¹ ë‚ ì§œì˜ ì¼ê¸° ëª©ë¡ ì¡°íšŒ (SELECT ... WHERE user_id = ? AND created_at LIKE 'YYYY-MM-DD%')
    activate Database
    Database-->>AuthServer: 3. ì¼ê¸° ëª©ë¡(id, title, emotion ë“±) ë°˜í™˜
    deactivate Database

    AuthServer-->>Client: 4. ì¼ê¸° ëª©ë¡ ë°ì´í„° ì‘ë‹µ
    deactivate AuthServer
</div></code></pre>
<h3 id="23-%EC%9D%BC%EA%B8%B0-%EC%83%81%EC%84%B8-%EB%82%B4%EC%9A%A9-%EC%A1%B0%ED%9A%8C">2.3. ì¼ê¸° ìƒì„¸ ë‚´ìš© ì¡°íšŒ</h3>
<p>ì‚¬ìš©ìê°€ ëª©ë¡ì—ì„œ íŠ¹ì • ì¼ê¸°ë¥¼ ì„ íƒí–ˆì„ ë•Œ, ì¼ê¸°ì˜ ì „ì²´ ë‚´ìš©ê³¼ AI ë¶„ì„ ê²°ê³¼ë¥¼ í•¨ê»˜ ì¡°íšŒí•˜ëŠ” íë¦„ì…ë‹ˆë‹¤.</p>
<pre><code class="language-mermaid"><div class="mermaid">sequenceDiagram
    participant Client as CBT-front (React-Native)
    participant AuthServer as Auth-server (Spring Boot)
    participant Database as MariaDB

    Client->>AuthServer: 1. ì¼ê¸° ìƒì„¸ ì¡°íšŒ ìš”ì²­ (GET /api/diary/{diaryId})
    activate AuthServer

    AuthServer->>Database: 2. ì¼ê¸° ë° ì—°ê´€ëœ ë¶„ì„ ë¦¬í¬íŠ¸ ì¡°íšŒ <br> (SELECT * FROM diary d LEFT JOIN report r ON d.report_id = r.id WHERE d.id = ?)
    activate Database
    Database-->>AuthServer: 3. ì¼ê¸° ë° ë¶„ì„ ë°ì´í„° ë°˜í™˜
    deactivate Database

    AuthServer-->>Client: 4. ìƒì„¸ ë°ì´í„°(ì¼ê¸°+ë¶„ì„) ì‘ë‹µ
    deactivate AuthServer
</div></code></pre>
<h3 id="24-%EC%9D%BC%EA%B8%B0-%EC%88%98%EC%A0%95">2.4. ì¼ê¸° ìˆ˜ì •</h3>
<p>ì‚¬ìš©ìê°€ ê¸°ì¡´ì— ì‘ì„±í–ˆë˜ ì¼ê¸°ì˜ ë‚´ìš©ì„ ìˆ˜ì •í•˜ê³  'ì €ì¥'ì„ ìš”ì²­í–ˆì„ ë•Œì˜ íë¦„ì…ë‹ˆë‹¤. (í˜„ì¬ ë¡œì§ì—ì„œëŠ” ìˆ˜ì • ì‹œ AI ì¬ë¶„ì„ì€ ìˆ˜í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.)</p>
<pre><code class="language-mermaid"><div class="mermaid">sequenceDiagram
    participant Client as CBT-front (React-Native)
    participant AuthServer as Auth-server (Spring Boot)
    participant Database as MariaDB

    Client->>AuthServer: 1. ì¼ê¸° ìˆ˜ì • ìš”ì²­ (PUT /api/diary/{diaryId}) <br> {title, content, weather}
    activate AuthServer

    AuthServer->>Database: 2. ìˆ˜ì •í•  ì¼ê¸° ì¡°íšŒ (ì†Œìœ ì í™•ì¸)
    activate Database
    Database-->>AuthServer: 3. ì¼ê¸° ì •ë³´ ë°˜í™˜
    deactivate Database

    alt ì†Œìœ ì ì¼ì¹˜
        AuthServer->>Database: 4. ì¼ê¸° ë‚´ìš© ì—…ë°ì´íŠ¸ (UPDATE diary SET ...)
        activate Database
        Database-->>AuthServer: 5. ì—…ë°ì´íŠ¸ ì™„ë£Œ
        deactivate Database

        AuthServer-->>Client: 6. ìˆ˜ì • ì„±ê³µ ì‘ë‹µ (200 OK)
    else ì†Œìœ ì ë¶ˆì¼ì¹˜ ë˜ëŠ” ì¼ê¸° ì—†ìŒ
        AuthServer-->>Client: 6. ì‹¤íŒ¨ ì‘ë‹µ (403 Forbidden / 404 Not Found)
    end
    deactivate AuthServer
</div></code></pre>
<h3 id="25-%EC%9D%BC%EA%B8%B0-%EC%82%AD%EC%A0%9C">2.5. ì¼ê¸° ì‚­ì œ</h3>
<p>ì‚¬ìš©ìê°€ íŠ¹ì • ì¼ê¸°ë¥¼ ì‚­ì œí•˜ëŠ” íë¦„ì…ë‹ˆë‹¤.</p>
<pre><code class="language-mermaid"><div class="mermaid">sequenceDiagram
    participant Client as CBT-front (React-Native)
    participant AuthServer as Auth-server (Spring Boot)
    participant Database as MariaDB

    Client->>AuthServer: 1. ì¼ê¸° ì‚­ì œ ìš”ì²­ (DELETE /api/diary/{diaryId})
    activate AuthServer

    AuthServer->>Database: 2. ì‚­ì œí•  ì¼ê¸° ì¡°íšŒ (ì†Œìœ ì í™•ì¸)
    activate Database
    Database-->>AuthServer: 3. ì¼ê¸° ì •ë³´ ë°˜í™˜
    deactivate Database

    alt ì†Œìœ ì ì¼ì¹˜
        AuthServer->>Database: 4. ì¼ê¸° ë° ì—°ê´€ëœ ë¦¬í¬íŠ¸ ì‚­ì œ (DELETE)
        note right of Database: Cascade ì„¤ì • ë˜ëŠ”<br>ì„œë¹„ìŠ¤ ë¡œì§ìœ¼ë¡œ Report í•¨ê»˜ ì‚­ì œ
        activate Database
        Database-->>AuthServer: 5. ì‚­ì œ ì™„ë£Œ
        deactivate Database

        AuthServer-->>Client: 6. ì‚­ì œ ì„±ê³µ ì‘ë‹µ (204 No Content)
    else ì†Œìœ ì ë¶ˆì¼ì¹˜ ë˜ëŠ” ì¼ê¸° ì—†ìŒ
        AuthServer-->>Client: 6. ì‹¤íŒ¨ ì‘ë‹µ (403 Forbidden / 404 Not Found)
    end
    deactivate AuthServer
</div></code></pre>
<hr>
<h2 id="%F0%9F%93%8A-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-%EA%B0%9C%EC%9A%94">ğŸ“Š í”„ë¡œì íŠ¸ ì•„í‚¤í…ì²˜ ê°œìš”</h2>
<pre><code class="language-mermaid"><div class="mermaid">graph TB
    subgraph "Client Layer"
        A[CBT-front<br/>React-Native]
    end

    subgraph "Server Layer"
        B[Auth-server<br/>Spring Boot]
        C[ai-server<br/>Python/FastAPI]
    end

    subgraph "Database Layer"
        D[(MariaDB<br/>Core Data)]
        E[(Redis<br/>Cache)]
    end

    subgraph "External Services"
        F[OpenAI API<br/>GPT Models]
    end

    A -->|API Requests| B
    B -->|AI Analysis| C
    C -->|LLM Requests| F
    B -->|Data Storage| D
    B -->|Token Cache| E
    C -->|Analysis Results| B
</div></code></pre>
<h2 id="%F0%9F%94%84-%EC%A0%84%EC%B2%B4-%EC%8B%9C%EC%8A%A4%ED%85%9C-%ED%94%8C%EB%A1%9C%EC%9A%B0">ğŸ”„ ì „ì²´ ì‹œìŠ¤í…œ í”Œë¡œìš°</h2>
<pre><code class="language-mermaid"><div class="mermaid">flowchart LR
    Start([ì‚¬ìš©ì ì•± ì‹¤í–‰]) --> Auth{ì¸ì¦ ìƒíƒœ}
    Auth -->|ë¡œê·¸ì¸ë¨| Main[ë©”ì¸ í™”ë©´]
    Auth -->|ë¯¸ë¡œê·¸ì¸| Login[ë¡œê·¸ì¸/íšŒì›ê°€ì…]

    Login --> Main
    Main --> Diary[ì¼ê¸° ì‘ì„±]
    Main --> Calendar[ìº˜ë¦°ë” ì¡°íšŒ]
    Main --> Analysis[ë¶„ì„ ê²°ê³¼ ì¡°íšŒ]

    Diary --> AI[AI ê°ì • ë¶„ì„]
    AI --> Save[ë°ì´í„° ì €ì¥]
    Save --> Main

    Calendar --> DiaryList[ì¼ê¸° ëª©ë¡]
    DiaryList --> DiaryDetail[ì¼ê¸° ìƒì„¸]
    DiaryDetail --> Edit[í¸ì§‘/ì‚­ì œ]
    Edit --> Main

    Analysis --> Report[ë¦¬í¬íŠ¸ ìƒì„±]
    Report --> Main
</div></code></pre>
<h2 id="%E2%9A%A1-%EC%A3%BC%EC%9A%94-%EA%B8%B0%EB%8A%A5%EB%B3%84-%EC%B2%98%EB%A6%AC-%EC%8B%9C%EA%B0%84">âš¡ ì£¼ìš” ê¸°ëŠ¥ë³„ ì²˜ë¦¬ ì‹œê°„</h2>
<table>
<thead>
<tr>
<th>ê¸°ëŠ¥</th>
<th>ì˜ˆìƒ ì²˜ë¦¬ ì‹œê°„</th>
<th>ë¹„ê³ </th>
</tr>
</thead>
<tbody>
<tr>
<td>íšŒì›ê°€ì…</td>
<td>200-500ms</td>
<td>ì´ë©”ì¼ ì¤‘ë³µ ì²´í¬ í¬í•¨</td>
</tr>
<tr>
<td>ë¡œê·¸ì¸</td>
<td>150-300ms</td>
<td>JWT í† í° ìƒì„±</td>
</tr>
<tr>
<td>ì¼ê¸° ì €ì¥</td>
<td>100-200ms</td>
<td>AI ë¶„ì„ì€ ë¹„ë™ê¸°</td>
</tr>
<tr>
<td>AI ê°ì • ë¶„ì„</td>
<td>2-5ì´ˆ</td>
<td>OpenAI API ì‘ë‹µ ì‹œê°„</td>
</tr>
<tr>
<td>ì¼ê¸° ëª©ë¡ ì¡°íšŒ</td>
<td>50-150ms</td>
<td>í˜ì´ì§• ì ìš© ì‹œ</td>
</tr>
<tr>
<td>ì¼ê¸° ìƒì„¸ ì¡°íšŒ</td>
<td>100-200ms</td>
<td>ì¡°ì¸ ì¿¼ë¦¬ í¬í•¨</td>
</tr>
</tbody>
</table>
<h2 id="%F0%9F%9B%A0%EF%B8%8F-%EA%B8%B0%EC%88%A0-%EC%8A%A4%ED%83%9D-%EC%83%81%EC%84%B8">ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ ìƒì„¸</h2>
<h3 id="frontend">Frontend</h3>
<ul>
<li><strong>React Native</strong>: í¬ë¡œìŠ¤ í”Œë«í¼ ëª¨ë°”ì¼ ì•±</li>
<li><strong>AsyncStorage</strong>: ë¡œì»¬ ë°ì´í„° ì €ì¥ (í† í°, ì‚¬ìš©ì ì„¤ì •)</li>
</ul>
<h3 id="backend">Backend</h3>
<ul>
<li><strong>Spring Boot</strong>: RESTful API ì„œë²„</li>
<li><strong>Spring Security</strong>: ì¸ì¦/ì¸ê°€ ì²˜ë¦¬</li>
<li><strong>JWT</strong>: í† í° ê¸°ë°˜ ì¸ì¦</li>
</ul>
<h3 id="ai-server">AI Server</h3>
<ul>
<li><strong>FastAPI</strong>: ë¹ ë¥¸ API ì‘ë‹µì„ ìœ„í•œ Python ì›¹ í”„ë ˆì„ì›Œí¬</li>
<li><strong>OpenAI API</strong>: GPT ëª¨ë¸ì„ í™œìš©í•œ ê°ì • ë¶„ì„</li>
</ul>
<h3 id="database">Database</h3>
<ul>
<li><strong>MariaDB</strong>: ì£¼ ë°ì´í„°ë² ì´ìŠ¤ (ì‚¬ìš©ì, ì¼ê¸°, ë¶„ì„ ê²°ê³¼)</li>
<li><strong>Redis</strong>: ìºì‹œ ë° ì„¸ì…˜ ê´€ë¦¬</li>
</ul>
<hr>
<p><em>ì´ ë¬¸ì„œëŠ” CBT Diary í”„ë¡œì íŠ¸ì˜ ì „ì²´ì ì¸ ë°ì´í„° íë¦„ì„ ì´í•´í•˜ëŠ” ë° ë„ì›€ì´ ë˜ë„ë¡ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ê° ë‹¤ì´ì–´ê·¸ë¨ì€ ì‹¤ì œ API ì—”ë“œí¬ì¸íŠ¸ì™€ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤.</em></p>

</body>
</html>
